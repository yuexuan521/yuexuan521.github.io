[{"content":"1 Introduction In today\u0026rsquo;s AI-driven world, \u0026ldquo;Prompt Engineer\u0026rdquo; has become a buzzword.\nAI enthusiasts are eager to share prompts, study token control, and tweak temperature parameters.\nThe classic meme from Linux founder Linus Torvalds\nTalk is cheap. Show me the code.\nhas evolved into:\nCode is cheap. Show me the prompts.\nOriginal tweet: https://x.com/tunguz/status/1856045530951917763?lang=en\nBut the core of effective AI interaction isn\u0026rsquo;t about technical jargonâ€”it\u0026rsquo;s about how to ask questions effectively.\nBack in 2001, Eric S. Raymond and Rick Moen wrote the classic guide How To Ask Questions The Smart Way.\nOriginally written for technical seekers in the open-source community during the rise of hacker culture, its principles prove surprisingly applicable to today\u0026rsquo;s AI interactions â€” because whether seeking help from experts or large models, it\u0026rsquo;s essentially about providing as much effective information as possible to get problem-solving answers quickly.\nAs the guide states:\nThe kind of answers you get to your technical questions depends as much on the way you ask the questions as on the difficulty of developing the answer.\nIn my daily work, whether asking colleagues or domain experts, I continue to quickly obtain the answers I need by applying the philosophy from \u0026ldquo;little book\u0026rdquo;.\nIn this new AI era, I\u0026rsquo;m applying the timeless wisdom of \u0026ldquo;asking questions the smart way\u0026rdquo; to the modern craft of prompt engineering.\n2 Do Your Own Homework First Try to find an answer by searching the archives of the forum or mailing list you plan to post to. Try to find an answer by searching the Web. Try to find an answer by reading the manual.\nAI is not your personal assistant, let alone a substitute for your own thinking.\nIf you toss out a vague \u0026ldquo;write me a program\u0026rdquo; without understanding the problem, the model can only guess.\nGood prompts should demonstrate the effort you\u0026rsquo;ve already made:\n\u0026ldquo;I tried to scrape a website using Python\u0026rsquo;s requests library but got a 403 error. I\u0026rsquo;ve checked my network connection and added a User-Agent header, but the problem persists. Do I need to handle cookies or consider JavaScript rendering?\nHere\u0026rsquo;s my error log: \u0026hellip;\u0026rdquo;\nThis not only helps AI pinpoint the issue more accurately but also reduces its futile attempts.\nAs Raymond advises:\nWhen you ask your question, display the fact that you have done these things first; this will help establish that you\u0026rsquo;re not being a lazy sponge and wasting people\u0026rsquo;s time.\n3 Describe Symptoms, Not Guesses Describe the problem\u0026rsquo;s symptoms, not your guesses.\nMany people tend to preset conclusions in their prompts: \u0026ldquo;My code has a memory leak,\u0026rdquo; \u0026ldquo;This API must have a bug.\u0026rdquo;\nBut AI lacks context and cannot verify your assumptions.\nProvide observable facts:\n\u0026ldquo;After running for 10 minutes, the program\u0026rsquo;s memory usage increases from 100MB to 2GB without release. Here are my core code snippets and resource monitoring data.\u0026rdquo;\nThe most common observable facts are logs and runtime data; for UI issues (like unexpected CSS rendering), providing screenshots is extremely helpful.\nThe key is: Your role is to present the evidence; let AI draw its own conclusions.\nAs the guide emphasizes:\nAll diagnosticians are from Missouri. Show us.\n4 Goal-Oriented, Not Step-Oriented Describe the goal, not the step.\nUsers often fall into \u0026ldquo;path dependency\u0026rdquo;: clinging to a specific tool or method while forgetting the ultimate goal.\nState the goal first, then the sticking point.\nBad question:\nStep-Oriented: \u0026ldquo;How do I use VLOOKUP in Excel to match two columns of data?\u0026rdquo; Good question:\nGoal-Oriented: \u0026ldquo;I want to merge two tables based on matching ID columns. I tried VLOOKUP but it returns #N/A. I\u0026rsquo;ve confirmed both data columns are text format.\u0026rdquo; This way, AI might suggest switching to XLOOKUP, Power Query, or even recommend using Python directlyâ€”**offering you a better solution, not just focusing on your specified step.**\n5 Be Concise, Specific, and Structured Volume is not precision.\nText length â‰  Information density.\nA 500-line code dump often carries less information density than a carefully refined, 10-line minimal reproducible example.\nWhile large models can handle long contexts, more noise means weaker effective signals.\nProvide a minimal reproducible example Specify the input, expected output, and actual output Organize information using clear formatting (like code blocks, lists) For example:\n1 2 3 4 Input: [1, 2, \u0026#39;3\u0026#39;, 4] Expected: Convert all to integers â†’ [1, 2, 3, 4] Actual: int() conversion throws an error Question: How to safely convert this mixed-type list? 6 Seek \u0026ldquo;Key Guidance,\u0026rdquo; Not \u0026ldquo;Complete Answers\u0026rdquo; While AI\u0026rsquo;s capabilities far exceed traditional Q\u0026amp;A scenarios, the key to efficient collaboration isn\u0026rsquo;t \u0026ldquo;full disclosure\u0026rdquo; but \u0026ldquo;step-by-step guidance.\u0026rdquo;\nIf you can\u0026rsquo;t be bothered to do that, we can\u0026rsquo;t be bothered to pay attention.\nIn the AI era, although AI can directly output complete answers, a phased interaction pattern â€” first outline the approach, then select solutions, finally generate code â€”is often more efficient, controllable, and reduces \u0026ldquo;hallucinations.\u0026rdquo;\nThis essentially treats AI as a collaborator rather than an oracle.\nMore efficient collaboration model:\nFirst, ask AI to explain the solution approach Provide 2-3 feasible solutions Compare the pros and cons of each (performance, maintainability, complexity, etc.) After human confirmation of the direction, proceed with detailed implementation This \u0026ldquo;phased collaboration\u0026rdquo; significantly reduces hallucinations, improves controllability, and keeps humans in charge of key decisions.\n7 Politeness + Closure = Long-term Win-Win Courtesy never hurts, and sometimes helps.\nAlthough AI has no emotions, structured politeness and feedback can shape higher-quality interactions:\nClearly state the context at the beginning; express thanks at the end If helped, provide follow-up feedback: \u0026ldquo;Following your suggestion, the problem is solved. Thank you!\u0026rdquo; While this feedback loop doesn\u0026rsquo;t directly trigger online learning in current static AI models, informing the model that its solution worked simulates the process of RLHF (Reinforcement Learning from Human Feedback).\nThe more you ask effectively, verify, and correct, the more AI \u0026ldquo;becomes\u0026rdquo; a collaborator that understands you.\nThis is the value of feedback.\nAdditionally, saying \u0026ldquo;please\u0026rdquo; and \u0026ldquo;thank you\u0026rdquo; to AI might come in handyâ€”just in case AI ever dominates human, it might spare you for having been polite:\nsource: https://old.reddit.com/r/comics/comments/x8bcu9/be_polite_to_robots/\n8 Conclusion: Asking Questions is a Skill and an Attitude The core of \u0026ldquo;How To Ask Questions The Smart Way\u0026rdquo; isn\u0026rsquo;t about \u0026ldquo;techniques\u0026rdquo; but attitude: respecting others\u0026rsquo; time, respecting the boundaries of knowledge, and respecting the complexity of the problem itself.\nIn the AI era, we have unprecedented access to \u0026ldquo;all-powerful instant experts,\u0026rdquo; but lazy questions only yield mediocre answers.\nTruly effective Prompt Engineers aren\u0026rsquo;t those who memorize prompts, but those who understand how to build understanding with AI. (Even though current AI remains essentially a probabilistic model.)\nAs the book wisely states:\nGood questions are a stimulus and a gift.\n9 Further Reading How To Ask Questions The Smart Way How to Report Bugs Effectively â€“ Simon Tatham ","permalink":"https://yuexuan521.github.io/en/post/2025/the-essence-of-prompt-engineering-is-the-art-of-asking-questions/","summary":"\u003ch2 id=\"introduction\"\u003e\u003cspan class=\"section-num\"\u003e1\u003c/span\u003e Introduction\u003c/h2\u003e\n\u003cp\u003eIn today\u0026rsquo;s AI-driven world, \u0026ldquo;Prompt Engineer\u0026rdquo; has become a buzzword.\u003c/p\u003e\n\u003cp\u003eAI enthusiasts are eager to share prompts, study token control, and tweak temperature parameters.\u003c/p\u003e\n\u003cp\u003eThe classic meme from Linux founder Linus Torvalds\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eTalk is cheap. Show me the code.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ehas evolved into:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCode is cheap. Show me the prompts.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cfigure\u003e\n    \n    \n    \u003cinput type=\"checkbox\" id=\"zoomCheck-f61ab\" hidden\u003e\n    \u003clabel for=\"zoomCheck-f61ab\"\u003e\n    \n    \n    \u003cimg class=\"zoomCheck\" loading=\"lazy\" src=\"/ox-hugo/talk_is_cheap_show_me_the_prompt.jpg\"/\u003e \n    \n    \n    \u003c/label\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eOriginal tweet: \u003ca href=\"https://x.com/tunguz/status/1856045530951917763?lang=en\"\u003ehttps://x.com/tunguz/status/1856045530951917763?lang=en\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eBut the core of effective AI interaction isn\u0026rsquo;t about technical jargonâ€”it\u0026rsquo;s about \u003cstrong\u003e\u003cstrong\u003ehow to ask questions effectively\u003c/strong\u003e\u003c/strong\u003e.\u003c/p\u003e","title":"The Essence of Prompt Engineering is the Art of Asking Questions"},{"content":"1 Prologue A while ago, I took a flight from Canada back to Hong Kong - about 12 hours in total with Air Canada.\nInterestingly, the plane actually had WiFi:\nHowever, the WiFi had restrictions. For Aeroplan members who hadn\u0026rsquo;t paid, it only offered Free Texting, meaning you could only use messaging apps like WhatsApp, Snapchat, and WeChat to send text messages, but couldn\u0026rsquo;t access other websites.\nIf you wanted unlimited access to other websites, it would cost CAD $30.75:\nAnd if you wanted to watch videos on the plane, that would be CAD $39:\nI started wondering: for the Free Texting service, could I bypass the messaging app restriction and access other websites freely?\nEssentially, could I enjoy the benefits of the $30.75 paid service without actually paying the fee? After all, with such a long journey ahead, I needed something interesting to pass the 12 hours.\nSince I could use WeChat in flight, I could also call for help from the sky.\nCoincidentally, my roommate happens to be a security and networking expert who was on vacation at home. When I mentioned this idea, he thought it sounded fun and immediately agreed to collaborate. So we started working on it together across the Pacific.\n2 The Process After selecting the only available WiFi network acwifi.com on the plane, just like other login-required WiFi networks, it popped up a webpage from acwifi.com asking me to verify my Aeroplan membership. Once verified, I could access the internet.\nThere\u0026rsquo;s a classic software development interview question: what happens after you type a URL into the browser and press enter?\nFor example, if you type https://acwifi.com and only focus on the network request part, the general process is: DNS query -\u0026gt; TCP connection -\u0026gt; TLS handshake -\u0026gt; HTTP request and response.\nLet\u0026rsquo;s consider github.com as our target website we want to access. Now let\u0026rsquo;s see how we can break through the network restrictions and successfully access github.com.\n3 Approach 1: Disguise Domain Since acwifi.com is accessible but github.com is not, is it possible that the network has imposed restrictions on the DNS server, only resolving domain names within a whitelist (such as instant messaging domains)?\nIf this is the case, can I modify /etc/hosts to disguise my server as acwifi.com, so that all request traffic passes through my server before reaching the target website (github.com)? For example:\nThe general idea is that I modify the DNS record to bind our proxy server\u0026rsquo;s IP 137.184.231.87 to acwifi.com. Since the local /etc/hosts file takes precedence over the DNS server, I can then use a self-signed certificate to tell the browser that this IP is bound to this domain and that it should trust it.\nLet me first test this idea:\n1 2 3 4 5 6 7 8 9 10 \u0026gt; ping 137.184.231.87 PING 137.184.231.87 (137.184.231.87): 56 data bytes Request timeout for icmp_seq 0 Request timeout for icmp_seq 1 Request timeout for icmp_seq 2 Request timeout for icmp_seq 3 Request timeout for icmp_seq 4 ^C --- 137.184.231.87 ping statistics --- 6 packets transmitted, 0 packets received, 100.0% packet loss Unexpectedly, the IP was completely unreachable via ping, meaning the IP was likely blocked entirely.\nI tried other well-known IPs, like Cloudflare\u0026rsquo;s CDN IP, and they were also unreachable:\n1 2 3 4 5 6 7 8 9 10 \u0026gt; ping 172.67.133.121 PING 172.67.133.121 (172.67.133.121): 56 data bytes Request timeout for icmp_seq 0 Request timeout for icmp_seq 1 Request timeout for icmp_seq 2 Request timeout for icmp_seq 3 Request timeout for icmp_seq 4 ^C --- 172.67.133.121 ping statistics --- 6 packets transmitted, 0 packets received, 100.0% packet loss It seems this approach won\u0026rsquo;t work. This approach might only work if:\nThe DNS server only answers queries for a specific list of domain names (e.g., WhatsApp, Snapchat, WeChat), which means the firewall\u0026rsquo;s filtering mechanism was solely based on DNS resolution. The network allows connections to arbitrary IP addresses After all, if the IPs are directly blocked, no amount of disguise will help. This network likely maintains some IP whitelist (such as WhatsApp and WeChat\u0026rsquo;s egress IPs), and only IPs on the whitelist can be accessed.\nIf a ping to a specific IP times out, I wouldn\u0026rsquo;t say the IP is blocked. It could be that ICMP specifically is blocked, following some network rules on the firewall. This is pretty common in entreprise networks to not allow endpoint discovery. I could be missing something and happy to be corrected here, but I was surprised to read that. \u0026ndash; HackerNews top comment\nhttps://news.ycombinator.com/item?id=45536325\nActually, I did verified whether only ICMP was blocked, was it possible to create a connection through TLS:\n1 2 3 4 5 6 7 8 \u0026gt; curl -Lkv https://172.67.133.121 * Trying 172.67.133.121:443... * Connected to 172.67.133.121 (172.67.133.121) port 443 * ALPN: curl offers h2,http/1.1 * (304) (OUT), TLS handshake, Client hello (1): * LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to 172.67.133.121:443 * Closing connection curl: (35) LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to 172.67.133.121:443 However, it turned out that both ICMP and TLS were blocked\n4 Approach 2: DNS Port Masquerading When the first approach failed, my roommate suggested a second approach: try using DNS service as a breakthrough:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026gt; dig http418.org ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.6 \u0026lt;\u0026lt;\u0026gt;\u0026gt; http418.org ;; global options: +cmd ;; Got answer: ;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 64160 ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ;; QUESTION SECTION: ;http418.org.\tIN\tA ;; ANSWER SECTION: http418.org.\t300\tIN\tA\t172.67.133.121 http418.org.\t300\tIN\tA\t104.21.5.131 ;; Query time: 3288 msec ;; SERVER: 172.19.207.1#53(172.19.207.1) ;; WHEN: Sat Oct 04 14:18:24 PDT 2025 ;; MSG SIZE rcvd: 94 This is good news! It means there are still ways to reach external networks, and DNS is one of them.\nLooking at the record above, it shows our DNS query for http418.org was successful, meaning DNS requests work.\n4.1 Arbitrary DNS Servers My roommate then randomly picked another DNS server to see if the network had a whitelist for DNS servers:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; dig @40.115.144.198 http418.org ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.6 \u0026lt;\u0026lt;\u0026gt;\u0026gt; @40.115.144.198 http418.org ; (1 server found) ;; global options: +cmd ;; Got answer: ;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 58958 ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 1224 ;; QUESTION SECTION: ;http418.org.\tIN\tA ;; ANSWER SECTION: http418.org.\t275\tIN\tA\t104.21.5.131 http418.org.\t275\tIN\tA\t172.67.133.121 ;; Query time: 1169 msec ;; SERVER: 40.115.144.198#53(40.115.144.198) ;; WHEN: Sat Oct 04 14:24:25 PDT 2025 ;; MSG SIZE rcvd: 72 We can actually use arbitrary DNS servers - even better!\n4.2 TCP Queries The fact that arbitrary DNS servers can be queried successfully is excellent news. DNS typically uses UDP protocol, but would TCP-based DNS requests be blocked?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026gt; dig @40.115.144.198 http418.org +tcp ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.6 \u0026lt;\u0026lt;\u0026gt;\u0026gt; @40.115.144.198 http418.org +tcp ; (1 server found) ;; global options: +cmd ;; Got answer: ;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 30355 ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 1224 ;; QUESTION SECTION: ;http418.org.\tIN\tA ;; ANSWER SECTION: http418.org.\t36\tIN\tA\t172.67.133.121 http418.org.\t36\tIN\tA\t104.21.5.131 ;; Query time: 4679 msec ;; SERVER: 40.115.144.198#53(40.115.144.198) ;; WHEN: Sat Oct 04 14:28:24 PDT 2025 ;; MSG SIZE rcvd: 72 DNS TCP queries also work! This indicates the plane network\u0026rsquo;s filtering policy is relatively lenient, standing a chance of our subsequent DNS tunneling approach.\n4.3 Proxy Service on Port 53 It seems the plane network restrictions aren\u0026rsquo;t completely airtight - we\u0026rsquo;ve found a \u0026ldquo;backdoor\u0026rdquo; in this wall.\nSo we had a clever idea: since the plane gateway doesn\u0026rsquo;t block DNS requests, theoretically we could disguise our proxy server as a DNS server, expose port 53 for DNS service, route all requests through the proxy server disguised as DNS requests, and thus bypass the restrictions.\nMy roommate spent about an hour setting up a proxy server exposing port 53 using xrayÂ 1, and sent me the configuration via WeChat:\nThe proxy server configuration my roommate set up with Xray included the following sample configuration:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 { \u0026#34;outbounds\u0026#34;: [ { \u0026#34;tag\u0026#34;: \u0026#34;proxy\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;vless\u0026#34;, \u0026#34;settings\u0026#34;: { \u0026#34;vnext\u0026#34;: [ { \u0026#34;address\u0026#34;: \u0026#34;our-proxy-server-domain\u0026#34;, \u0026#34;port\u0026#34;: 53, \u0026#34;users\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;some-uuid\u0026#34;, \u0026#34;flow\u0026#34;: \u0026#34;xtls-rprx-vision\u0026#34;, \u0026#34;encryption\u0026#34;: \u0026#34;none\u0026#34;, \u0026#34;level\u0026#34;: 0 } ] } ] }, \u0026#34;streamSettings\u0026#34;: { \u0026#34;network\u0026#34;: \u0026#34;tcp\u0026#34;, \u0026#34;security\u0026#34;: \u0026#34;tls\u0026#34;, \u0026#34;tlsSettings\u0026#34;: { \u0026#34;allowInsecure\u0026#34;: false, \u0026#34;allowInsecureCiphers\u0026#34;: false, \u0026#34;alpn\u0026#34;: [ \u0026#34;h2\u0026#34; ] } } }, { \u0026#34;tag\u0026#34;: \u0026#34;direct\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;freedom\u0026#34; }, { \u0026#34;tag\u0026#34;: \u0026#34;block\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;blackhole\u0026#34; } ] } And I already had an xray client on my computer, so no additional software was needed to establish the connection.\nEverything was ready. The exciting moment arrived - pressing enter to access github.com:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 /Users/ramsayleung [ramsayleung@ramsayleungs-Laptop] [18:28] \u0026gt; curl -v github.com -x socks5://127.0.0.1:10810 * Trying 127.0.0.1:10810... * Connected to 127.0.0.1 (127.0.0.1) port 10810 * SOCKS5 connect to 172.19.1.1:80 (locally resolved) * SOCKS5 request granted. * Connected to 127.0.0.1 (127.0.0.1) port 10810 \u0026gt; GET / HTTP/1.1 \u0026gt; Host: github.com \u0026gt; User-Agent: curl/8.4.0 \u0026gt; Accept: */* \u0026gt; \u0026lt; HTTP/1.1 301 Moved Permanently \u0026lt; Content-Length: 0 \u0026lt; Location: https://github.com/ \u0026lt; * Connection #0 to host 127.0.0.1 left intact /Users/ramsayleung [ramsayleung@ramsayleungs-Laptop] [18:28] \u0026gt; curl -v github.com -x socks5://127.0.0.1:10810 * Trying 127.0.0.1:10810... * Connected to 127.0.0.1 (127.0.0.1) port 10810 * SOCKS5 connect to 172.19.1.1:80 (locally resolved) * SOCKS5 request granted. * Connected to 127.0.0.1 (127.0.0.1) port 10810 \u0026gt; GET / HTTP/1.1 \u0026gt; Host: github.com \u0026gt; User-Agent: curl/8.4.0 \u0026gt; Accept: */* \u0026gt; \u0026lt; HTTP/1.1 301 Moved Permanently \u0026lt; Content-Length: 0 \u0026lt; Location: https://github.com/ \u0026lt; * Connection #0 to host 127.0.0.1 left intact The request actually succeeded! github.com returned a successful result!\nThis means we\u0026rsquo;ve truly broken through the network restrictions and can access any website!\nWe hadn\u0026rsquo;t realized before that xray could be used in this clever way :)\nHere we exploited a simple cognitive bias: not all services using port 53 are DNS query requests.\n5 Ultimate Approach: DNS Tunnel If Approach 2 still didn\u0026rsquo;t work, we had one final trick up our sleeves.\nCurrently, the gateway only checks whether the port is 53 to determine if it\u0026rsquo;s a DNS request. But if the gateway were stricter and inspected the content of DNS request packets, it would discover that our requests are \u0026ldquo;disguised\u0026rdquo; as DNS queries rather than genuine DNS queries:\nSince disguised DNS requests would be blocked, we could embed all requests inside genuine DNS request packets, making them DNS TXT queries. We\u0026rsquo;d genuinely be querying DNS, just with some extra content inside:\nHowever, this ultimate approach requires a DNS Tunnel client to encapsulate all requests(for example: https://github.com/yarrick/iodine). Unfortunately, I didn\u0026rsquo;t have such software on my computer while I was on board, so this remained a theoretical ultimate solution that couldn\u0026rsquo;t be practically verified.\n6 Conclusion With the long journey ahead, my roommate and I spent about 4 hours remotely breaking through the network restrictions, having great fun in the process, proving that our problem-solving approach was indeed feasible.\nThe successful implementation of the solution was mainly thanks to my roommate, the networking expert, who provided remote technical and conceptual support.\nThe only downside was that although we broke through the network restrictions and could access any website, the plane\u0026rsquo;s bandwidth was extremely limited, making web browsing quite painful. So I didn\u0026rsquo;t spend much time browsing the web.\nFor the remaining hours, I rewatched the classic 80s time-travel movie: \u0026quot;Back to the Future\u0026quot; , which was absolutely fantastic.\nLast and not least, it\u0026rsquo;s the disclaimer:\nThis technical exploration is intended solely for educational and research purposes. We affirm our strict adherence to all relevant regulations and service terms throughout this project.\nDiscuss this post on HackerNews, or Reddit\n7 Follow up: Can we bypass the speed limit? There\u0026rsquo;s a speed limit. No matter what you try, you can\u0026rsquo;t break through it.\nThe bandwidth for free texting is the ultimate bottleneck. Even if you bypass the restrictions, without solving the bandwidth issue, you can\u0026rsquo;t use it like paid Wi-Fi ğŸ˜­\nThis is a comment from a reader. Is this true?\nNot exactly.\nThere are actually ways to bypass it. During communication on the network, there is no business marker indicating \u0026ldquo;paid user\u0026rdquo; attached. So, if I were designing this paid system, after a user pays, I would add the unique identifier of the paid user\u0026rsquo;s device, typically the MAC address, to the gateway\u0026rsquo;s whitelist. Then, all traffic from that MAC address could use the higher-bandwidth line.\nFurthermore, because of this whitelist, even if free users bypass the free texting restrictions, they still cannot enjoy the higher bandwidth â€“ killing two birds with one stone.\nOnce we guess this principle, I can \u0026ldquo;pretend to be a paid user.\u0026rdquo;\nSince the MAC address is essentially assigned by the computer itself and then communicated to the gateway using the ARP protocol.\nThe ARP (Address Resolution Protocol) is used to resolve an IP address into its corresponding MAC address. The basic idea of the ARP protocol is to broadcast an ARP request within the network:\nGateway: Whose IP address is 192.168.1.100? Please tell me your MAC address. Device with that IP: I am 192.168.1.100, my MAC address is XX:XX:XX:XX:XX:XX.\nThe ARP protocol itself has no security verification mechanism â€“ it unconditionally trusts the received ARP replies. I could also tell the gateway that my IP address corresponds to the MAC address of a user who has already paid. This way, all traffic coming from me would enjoy the benefits of the paid line. This is the so-called ARP Spoofing.\nThe final question is, how do we know which MAC address belongs to a paid user?\nIt\u0026rsquo;s quite easy, just brute-force: try every known MAC address in the network. If there is a paid user\u0026rsquo;s MAC address, requests from that MAC address should definitely be able to access sites like YouTube/Netflix. This can easily be automated and detected with a script.\nMy previous solution of disguising the DNS server would not affect the aircraft\u0026rsquo;s network in any way, nor would it intrude into any aircraft systems. It\u0026rsquo;s essentially the same as running a VPN on your computer that uses port 53.\nHowever, this ARP Spoofing method is very \u0026ldquo;criminal\u0026rdquo; â€“ as it constitutes unauthorized access to the plane\u0026rsquo;s network system. I\u0026rsquo;ll just share the idea here; I don\u0026rsquo;t want FBI or RCMP waiting for me at the gate when the airplane lands\nhttps://github.com/XTLS/Xray-core\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://yuexuan521.github.io/en/post/2025/a_story_about_bypassing_air_canadas_in-flight_network_restrictions/","summary":"\u003ch2 id=\"prologue\"\u003e\u003cspan class=\"section-num\"\u003e1\u003c/span\u003e Prologue\u003c/h2\u003e\n\u003cp\u003eA while ago, I took a flight from Canada back to Hong Kong - about 12 hours in total with Air Canada.\u003c/p\u003e\n\u003cp\u003eInterestingly, the plane actually had WiFi:\u003c/p\u003e\n\n\u003cfigure\u003e\n    \n    \n    \u003cinput type=\"checkbox\" id=\"zoomCheck-a931d\" hidden\u003e\n    \u003clabel for=\"zoomCheck-a931d\"\u003e\n    \n    \n    \u003cimg class=\"zoomCheck\" loading=\"lazy\" src=\"/ox-hugo/acwifi-connect-2.png\"/\u003e \n    \n    \n    \u003c/label\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eHowever, the WiFi had restrictions. For Aeroplan members who hadn\u0026rsquo;t paid, it only offered \u003ca href=\"https://www.aircanada.com/ca/en/aco/home/fly/onboard/in-flight-entertainment-and-connectivity.html#/\"\u003eFree Texting\u003c/a\u003e, meaning you could only use messaging apps like WhatsApp, Snapchat, and WeChat to send text messages, but couldn\u0026rsquo;t access other websites.\u003c/p\u003e\n\u003cp\u003eIf you wanted unlimited access to other websites, it would cost CAD $30.75:\u003c/p\u003e","title":"A Story About Bypassing Air Canada's In-flight Network Restrictions"},{"content":"1 Preface I spent a weekend building a Telegram spam blocker bot based on Bayesian Algorithm @BayesSpamSniperBot (https://t.me/BayesSpamSniperBot). The project is open-sourced at: https://github.com/ramsayleung/bayes_spam_sniper\n1.1 Telegram Telegram is a popular instant messaging application, similar to Snapchat and WhatsApp, with over 1 billion users.\nIt supports many powerful features like cloud chat history storage, clients for Linux, Mac, Windows, Android, IOS, and Web (all open-source), Channel, and arguably the most powerful bot system I\u0026rsquo;ve ever seen.\n2 Origin I usually listen to podcasts while running and cooking. ã€Šè½¯ä»¶é‚£äº›äº‹å„¿(A podcast in Chinese about history and story behind software)ã€‹1 is one of my favorites, hosted by æ ‹å“¥Â 2. Because I enjoyed æ ‹å“¥\u0026rsquo;s show, I took the chance to join his Telegram channel.\næ ‹å“¥\u0026rsquo;s Telegram channel æ±—ç‰›å……æ ‹Â 3 is primarily used for releasing podcast information. He once enabled the comment for channel, but it unexpectedly attracted a flood of crypto-related users posting spam, leading him to disable comments:\nAnother channel I subscribe, Ray TracingÂ 4, also complained about the crypto spam:\n3 Hackers \u0026amp; Painters Most common Telegram spam blocker bots are keyword-based, blocking messages by matching keywords, which can be easily bypassed by spammers.\nIf the messages get bypassed, it could only be deleted manually by administrator.\nThis reminded me of the situation Paul Graham described in his 2002 essay within \u0026ldquo;Hackers \u0026amp; Painters\u0026rdquo;:\nWhen email became popular, there was also a lot of spam. Common spam blockers were keyword matching + email address blacklists, but these were inefficient and easily circumvented.\nPaul Graham creatively used Bayesian Theorem to implement a spam blockerÂ 5, and the results were surprisingly effective.\nIsn\u0026rsquo;t this a similar problem for Telegram spam?\nCouldn\u0026rsquo;t I use a similar solution to tackle Telegram spam?\n3.1 Bayes\u0026rsquo; Theorem When it comes to probabilistic algorithms, the most classic example is the \u0026ldquo;coin toss\u0026rdquo; â€“ a case of classical probability where each toss is an independent event, and the previous outcome doesn\u0026rsquo;t affect the next probability.\nHowever, many real-world scenarios aren\u0026rsquo;t infinitely repeatable like coin tosses, and events are often not independent.\nThis is where Bayes Theorem shows its unique value.\nIt used to update our degree of belief in a hypothesis given certain evidence.\nIn other words, the Bayes algorithm can dynamically adjust the estimated probability of an event occurring based on continuously emerging new evidence.\nSimply put, it\u0026rsquo;s like the human brain\u0026rsquo;s learning process: we start with a preliminary understanding, then revise our original view based on new information, thereby adjusting our next actions.\nPaul Graham used Bayes theorem to continuously classify new emails as spam or not based on emails already identified as spam or non-spam (ham).\nTo understand Bayes Theorem more intuitively, I recommend this clear and easy-to-understand videos:\nã€ŠBayes theorem, the geometry of changing beliefsã€‹6 4 Architecture Design Telegram Bot supports two modes of interacting with Telegram servers:\nWebhook: Telegram servers actively callback a URL previously registered by the Bot whenever the Bot receives a new message. The Bot Server only needs to handle the callback messages.\nLong Polling: The Bot Server continuously polls the Telegram servers to check for new messages and processes them if any. This bot uses this mode.\n4.0.1 Message Analysis After the Bot Server receives a message, it dispatches it to a separate telegram_bot_worker for processing. Based on the pre-trained model, it judges whether it\u0026rsquo;s a spam. If it is, it calls the Bot API to delete the message.\n4.0.2 Ban and Train After the Bot Server receives a message, it dispatches it to a separate telegram_bot_worker for processing. The telegram_bot_worker calls the bot API to delete the message and ban the user, and inserts a training data record marked as spam.\nSaving the training data triggers a hook, creating a training message delivered to the training message queue. Another worker, classifier_trainer, subscribes to training messages and uses the new messages to retrain and update the model.\nUsing a queue and a background process (classifier_trainer) for training tasks, instead of directly using the telegram_bot_worker, primarily decouples the Bot request handling from model training. Otherwise, as the model size increases, training time would get longer and longer, leading to increasingly long response times.\nDecoupling makes it easy to scale.\n5 Why Rails whoever have seen my project source code might wonder, why was it implemented using Ruby on Rails?\nBecause I work with JVM languages (Java/Kotlin/Scala) and Rust, I\u0026rsquo;m quite familiar with Java/Rust. Initially, thinking model training might require high performance, my first prototypeÂ 7 was implemented in Rust, taking about half an hour.\nBut when I wanted to expand the prototype into a Telegram bot, I found I needed to handle a lot of logic related to bot interaction, mainly involving API and database operations, most of which were unrelated to the model. So, I thought of Ruby on Rails again.\nFor a single engineer building a product prototype, in my personal opinion, there\u0026rsquo;s really no framework more efficient than Ruby on Rails, so I switched to Ruby on Rails.\nNew features in Rails 8 move it further towards being a so-called \u0026ldquo;one-person full-stack framework,\u0026rdquo; with built-in support for Solid Queue via the relational database.\nThe queue and background process from the architecture design were implemented with just a few lines of code, without even needing extra configuration. If the queue doesn\u0026rsquo;t exist, the framework creates it automatically:\n1 2 3 4 5 6 7 8 class ClassifierTrainerJob \u0026lt; ApplicationJob # Job to train classifier asynchronously queue_as :training def perform(group_id, group_name) SpamClassifierService.rebuild_for_group(group_id, group_name) end end Thanks to Rails\u0026rsquo; powerful ORM framework and its built-in lifecycle hooks, the code to trigger the background process for retraining the model after inserting new training data is also just a few lines:\n1 2 3 4 5 6 7 8 9 10 class TrainedMessage \u0026lt; ApplicationRecord # Automatically train classifier after creating/updating a message after_create :retrain_classifier after_destroy :retrain_classifier def retrain_classifier # For efficiency, we could queue this as a background job ClassifierTrainerJob.perform_later(group_id, group_name) end end Empowered by Rails\u0026rsquo; various built-in powerful tools, I implemented the entire bot\u0026rsquo;s functionality in just one day.\nSeeing this, some friends might worry about performance, thinking Ruby\u0026rsquo;s performance isn\u0026rsquo;t great, and it\u0026rsquo;s a dynamic language, making it hard to maintain.\nMy view remains the same as in my previous blog post ã€ŠThoughts on a Decade of Programming(In Chinese)ã€‹8:\nGet it running first.\nBuild a prototype and get it running. See if users are willing to use your product first.\nWhen running speed becomes a bottleneck, your business must be very successful, and you\u0026rsquo;ll surely have enough resources to hire a team of programmers to optimize the project into Rust/C++, or even assembly.\nWithout users, discussing performance is a pseudo-proposition.\nAs for the saying \u0026ldquo;dynamic languages are fast in the moment, but maintaining the code is a nightmare\u0026rdquo; I quite agree with that too.\nTherefore, I won\u0026rsquo;t consider dynamic languages when choosing a tech stack for a team; I would only use compiled languages, even strong-typed ones like Rust.\nBut right now, it\u0026rsquo;s just me building a prototype, so I use whatever I\u0026rsquo;m most proficient with.\n5.1 Vibe Coding? Concepts like Vibe Coding and AI programming are everywhere, overwhelming the discourse. You might naturally wonder if this project was generated by Vibe Coding.\nThe answer is, I tried for a few hours and then gave up entirely. I tried both Claude 4 and Gemini 2.5 Pro.\nI started with a Rust + Cloudflare Worker tech stack. Rust + Cloudflare Worker is a relatively niche field with limited training data. The code generated by Vibe Coding failed to compile.\nLater, I switched to Ruby on Rails, and the problems became even worse. Ruby is a dynamic language; its syntax is almost like English, and Rails has many \u0026ldquo;black magic\u0026rdquo; metaprogramming features.\nSo errors only appeared at runtime. The development time saved by code generation was entirely consumed by the debugging process.\nAnother issue is that code generated by Vibe Coding often lacks design. For example, it tightly coupled the Classifier and TrainedMessage classes, having the Classifier persist TrainedMessage instances.\nIt also directly performed synchronous model training within the telegram_bot_worker process upon receiving training data, waiting for training to finish before returning the command result, completely neglecting to decouple receiving training data from model training.\nOne can only say that Vibe Coding is quite suitable for strongly-typed, compiled languages like Rust â€“ at least the generated code has to compile.\nAs for those claims of \u0026ldquo;making an APP without writing/changing a single line of code,\u0026rdquo; I can\u0026rsquo;t help but wonder:\nIs the code so good that it doesn\u0026rsquo;t need a single change? Or can the developer not identify the crux of the problem, and thus doesn\u0026rsquo;t change anything?\n6 Design Philosophy After developing the prototype and making the bot\u0026rsquo;s core functionality usable, many ideas popped into my head.\nI immediately rushed to add them to the bot, resulting in support for nearly ten commands, plus different modes for private chats and group chats.\nBut I felt something was off. Adding so many features felt like those all-in-one super apps common in China. I began to question:\nWould users really use all these features? Would any users use these features? Don\u0026rsquo;t too many features also create extra cognitive burden?\nMy favorite ad blocker, Ublock OriginÂ 9, is powerful and extremely effective at blocking, yet very simple and easy to use.\nRecalling the design philosophy mentioned in ã€ŠA Philosophy of Software Design(My thought about the book in Chinese)ã€‹10, the interface should be simple and easy to use, even if the functionality underneath is complex and rich.\nSo, I first removed all commands I considered unrelated to the core functionality.\nFurthermore, considering that most users might not have a technical background and might not know how to use commands, I optimized the interface to use buttons as much as possible, allowing users to click directly, improving usability:\nI also wanted to support multiple languages (e.g., automatically switching to Chinese or English based on the user\u0026rsquo;s system language). This required decent Internationalization support.\nOver 60% of the code in the core service class telegram_botter.rb was introduced for such usability improvements.\nSimplicity for the user, complexity for the developer.\n6.1 How to Use Just two steps, and the bot works automatically.\nAdd the bot (@BayesSpamSniperBot) to your group Grant the bot admin permissions (Delete messages, Ban users) After these two steps, the bot will not only start working automatically, identifying spam within the group, deleting text messages, and banning users who send spam more than 3 times;\nIt will also become smarter with community usage (via /markspam and /feedspam).\nThe design philosophy of this bot is to minimize disruption to admins and users, provide simple operation commands, and maximize automation. Therefore, this bot only offers the following three commands (supporting auto-completion with \u0026ldquo;/\u0026rdquo;):\n6.1.1 /markspam Delete spam messages and ban the user. Requires admin permissions.\nReply /markspam to the message you want to ban, and the bot will automatically delete that message and ban the user.\n(Message has also been deleted) Unlike common group management bots, this command not only deletes the spam and bans the user but also, because this message is marked as spam by an admin with very high confidence, uses this spam ad as training data to update the model in real-time.\nSimilar messages will not only be identified next time, but all groups using this bot will benefit, as similar texts will also be marked as spam.\n6.1.2 /listspam View the list of spam messages. Requires admin permissions.\nView the list of spam messages and proactively mark false positive spam as normal.\n6.1.3 /listbanuser View the list of banned accounts. Requires admin permissions.\nView the list of banned users and proactively unban them.\n6.1.4 /feedspam Feed spam messages for training. No permissions required. Can be used in private chat or in-group.\nFeeding in private chat:\nFeeding in-group:\n7 Eating your own dog food In the software development field, there\u0026rsquo;s a saying: \u0026ldquo;Eating your own dog food,\u0026rdquo; which means you should use the things you develop yourself.\nSo I created my own channel for testing: è èæ²¹ä¸å¤©å…‰å¢ŸÂ 11. Unfortunately, it has very few subscribers, which fails to attract many spammers. So everyone is welcome to subscribe or come in to post spam, to attract more spammers.\nIn my channel, everyone has the right to speak freely :-) (the only slight drawback is a limit on frequency ).\nSince no one was posting spam in my channel, and suffering from a lack of training data, I had to do it in the hard way: to join various crypto groups, NSFW groups, and actively seek out spam:\nThe screenshots are Chinese Telegram group contains a lot of spammers and spam:\nSince developing this bot, my perspective on spam has changed. I used to find spam annoying in other groups, but now I\u0026rsquo;m happy to see them in other groups, as they are valuable training data that I need to record quickly before they get deleted.\n7.1 The Ingenuity of Spam The algorithm\u0026rsquo;s effectiveness in other people\u0026rsquo;s stories is always surprisingly good, but when I run it myself, I always find various uncovered cases and unexpected surprises, just like life.\nAlthough keyword blocker is inefficient, the spam we actually see are those that have already bypassed keyword filters.\nFor example:\nåœ¨ å¸åœˆ æƒ³ èµš é’±ï¼Œé‚£ ä½  ä¸å…³ æ³¨ è¿™ ä¸ª ç‹ ç‰Œ ç¤¾ åŒºï¼ŒçœŸçš„å¤ªå¯æƒœäº†ï¼ŒçœŸ å¿ƒ æ¨ èï¼Œæ¯ å¤© éƒ½ æœ‰ å… è´¹ ç­– ç•¥ (Want to make money in the crypto circle? It\u0026rsquo;s a real pity if you don\u0026rsquo;t follow this ace community. Sincerely recommended, free strategies every day)\nOr\nè¿™äººç®€-ä»‹æŒ‚çš„ åˆ-çº¦-æŠ¥å•ç¾¤ç»„æŒºç‰›çš„ETH500ç‚¹ï¼Œå¤§é¥¼5200ç‚¹ï¼ + @BTCETHl6666 (The contract reporting group linked in this person\u0026rsquo;s bio is pretty awesome. ETH to $500, BTC to $5200! + @BTCETHl6666)\nThe former uses spaces to bypass keywords, the latter uses punctuation.\nUnlike languages based on the Latin alphabet which naturally use spaces for word separation, Chinese requires word segmentation before statistical analysis with Bayes\u0026rsquo; theorem.\nthe fox jumped over the lazy dog\næˆ‘ä»¬çš„ä¸­æ–‡å°±ä¸ä¸€æ ·äº†(Our Chinese is different)\n\u0026ldquo;æˆ‘ä»¬çš„ä¸­æ–‡å°±ä¸ä¸€æ ·äº†\u0026rdquo; (Our Chinese is different) would be segmented into \u0026ldquo;æˆ‘ä»¬ | çš„ | ä¸­æ–‡ | å°± | ä¸ | ä¸€æ · | äº†\u0026rdquo; before word frequency can be counted.\nBut for the spam åœ¨ å¸åœˆ æƒ³ èµš é’±ï¼Œé‚£ ä½  ä¸å…³ æ³¨ è¿™ ä¸ª ç‹ ç‰Œ ç¤¾ åŒºï¼ŒçœŸçš„å¤ªå¯æƒœäº†ï¼ŒçœŸ å¿ƒ æ¨ èï¼Œæ¯ å¤© éƒ½ æœ‰ å… è´¹ ç­– ç•¥, the spaces not only affect keyword matching but also affect segmentation. The segmentation result for this sentence becomes(incorrect):\nåœ¨ | | å¸åœˆ | | æƒ³ | | èµš | | é’± | ï¼Œ | é‚£ | | ä½  | | ä¸ | å…³ | | æ³¨ | | è¿™ | | ä¸ª | | ç‹ | | ç‰Œ | | ç¤¾ | | åŒº | ï¼Œ | çœŸçš„ | å¤ª | å¯æƒœ | äº† | ï¼Œ | çœŸ | | å¿ƒ | | æ¨ | | è | ï¼Œ | æ¯ | | å¤© | | éƒ½ | | æœ‰ | | å… | | è´¹ | | ç­– | | ç•¥\nè¿™äººç®€-ä»‹æŒ‚çš„ åˆ-çº¦-æŠ¥å•ç¾¤ç»„æŒºç‰›çš„ETH500ç‚¹ï¼Œå¤§é¥¼5200ç‚¹ï¼ + @BTCETHl6666 would be segmented into:\nè¿™äººç®€ | - | ä»‹æŒ‚ | çš„ | | åˆ | - | çº¦ | - | æŠ¥å• | ç¾¤ç»„ | æŒº | ç‰› | çš„ | ETH500 | ç‚¹ | ï¼Œ | å¤§é¥¼ | 5200 | ç‚¹ | ï¼ | | + | | @ | BTCETHl6666\nUnsanitized training data would affect the model\u0026rsquo;s results, showing the importance of training data quality. Therefore, I performed corresponding preprocessing on the training data:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # Step 1: Handle anti-spam separators # This still handles the cases like \u0026#34;åˆ-çº¦\u0026#34; -\u0026gt; \u0026#34;åˆçº¦\u0026#34; previous = \u0026#34;\u0026#34; while previous != cleaned previous = cleaned.dup cleaned = cleaned.gsub(/([ä¸€-é¾¯A-Za-z0-9])[^ä¸€-é¾¯A-Za-z0-9]+([ä¸€-é¾¯A-Za-z0-9])/, \u0026#39;\\1\\2\u0026#39;) end # Step 2: Handle anti-spam SPACES between Chinese characters # This specifically targets the \u0026#34;æƒ³ èµš é’±\u0026#34; -\u0026gt; \u0026#34;æƒ³èµšé’±\u0026#34; case. # We run it in a loop to handle multiple spaces, e.g., \u0026#34;ç¤¾ åŒº\u0026#34; -\u0026gt; \u0026#34;ç¤¾åŒº\u0026#34; previous = \u0026#34;\u0026#34; while previous != cleaned previous = cleaned.dup # Find a Chinese char, followed by one or more spaces, then another Chinese char cleaned = cleaned.gsub(/([ä¸€-é¾¯])(\\s+)([ä¸€-é¾¯])/, \u0026#39;\\1\\3\u0026#39;) end # Step 3: Add strategic spaces # This helps jieba segment properly, e.g., \u0026#34;ç¤¾åŒºETH\u0026#34; -\u0026gt; \u0026#34;ç¤¾åŒº ETH\u0026#34; cleaned = cleaned.gsub(/([ä¸€-é¾¯])([A-Za-z0-9])/, \u0026#39;\\1 \\2\u0026#39;) cleaned = cleaned.gsub(/([A-Za-z0-9])([ä¸€-é¾¯])/, \u0026#39;\\1 \\2\u0026#39;) # Step 4: Remove excessive space cleaned = cleaned.gsub(/\\s+/, \u0026#39; \u0026#39;).strip After preprocessing, åœ¨ å¸åœˆ æƒ³ èµš é’±ï¼Œé‚£ ä½  ä¸å…³ æ³¨ è¿™ ä¸ª ç‹ ç‰Œ ç¤¾ åŒºï¼ŒçœŸçš„å¤ªå¯æƒœäº†ï¼ŒçœŸ å¿ƒ æ¨ èï¼Œæ¯ å¤© éƒ½ æœ‰ å… è´¹ ç­– ç•¥ becomes åœ¨å¸åœˆæƒ³èµšé’±é‚£ä½ ä¸å…³æ³¨è¿™ä¸ªç‹ç‰Œç¤¾åŒºçœŸçš„å¤ªå¯æƒœäº†çœŸå¿ƒæ¨èæ¯å¤©éƒ½æœ‰å…è´¹ç­–ç•¥ (Note: legitimate commas are also removed here. I find the segmentation result acceptable compared to the impact of excessive punctuation). Its segmentation is:\nåœ¨ | å¸åœˆ | æƒ³ | èµšé’± | é‚£ | ä½  | ä¸ | å…³æ³¨ | è¿™ä¸ª | ç‹ç‰Œ | ç¤¾åŒº | çœŸçš„ | å¤ª | å¯æƒœ | äº† | çœŸå¿ƒ | æ¨è | æ¯å¤© | éƒ½ | æœ‰ | å…è´¹ | ç­–ç•¥\nè¿™äººç®€-ä»‹æŒ‚çš„ åˆ-çº¦-æŠ¥å•ç¾¤ç»„æŒºç‰›çš„ETH500ç‚¹ï¼Œå¤§é¥¼5200ç‚¹ï¼ + @BTCETHl6666 becomes è¿™äººç®€ä»‹æŒ‚çš„åˆçº¦æŠ¥å•ç¾¤ç»„æŒºç‰›çš„ ETH500 ç‚¹å¤§é¥¼ 5200 ç‚¹ï¼ + @BTCETHl6666. Its segmentation is:\nè¿™ | äºº | ç®€ä»‹ | æŒ‚ | çš„ | åˆçº¦ | æŠ¥å• | ç¾¤ç»„ | æŒº | ç‰› | çš„ | | ETH500 | | ç‚¹ | å¤§é¥¼ | | 5200 | | ç‚¹ | ï¼ | | + | | @ | BTCETHl6666\n7.1.1 Genius New Tricks Seeing many spam, I has to admire the creativity of spammers.\nBecause sending spam in messages gets caught by blockers, they innovatively came up with new tricks:\nThe messages contain normal text, but the profile picture and username are spam. This way, the spam blocker can\u0026rsquo;t work. Truly ingenious.\nFaced with such creative opponents, I adapted by building a training model for usernames. During detection, both the message text model and the username model are checked. If either one considers it spam, it gets blocked.\nOne could go further by doing OCR on profile pictures to extract text and add another model for profile pictures, but OCR is quite costly, so I\u0026rsquo;ll hold off for now.\n7.2 Optimization Without users, any optimization is unnecessary, as premature optimization is the root of all evil. Therefore, I focus on building the prototype first. But this doesn\u0026rsquo;t mean the prototype has no room for optimization.\nI have several optimization ideas in mind:\njieba\u0026rsquo;s segmentation might not be the best; other NLP algorithms could be used later for optimization. Retraining on every single training message is inefficient. A batching mechanism could be added, waiting for 5 minutes or accumulating 100 messages before processing. Currently, the entire model is computed in memory and persisted to the DB after calculation. A cache layer between memory and the database could optimize performance. The Bayesian algorithm might not be effective enough; a more complex machine learning model could be used. But these optimization points are all Good to have, not Must have. I\u0026rsquo;ll optimize them when actual problems arise later.\n8 Does it capture spam? Sending a message using transformed spam words:\nSuccessfully detected and automatically deleted:\nSome you might say this is just a demo showcase. Why are spam posted by others in my group still not being detected?\nBecause the Bayesian algorithm is fundamentally a probability-based algorithm. If it hasn\u0026rsquo;t encountered similar spam before, it cannot determine whether they are spam :(\nBe patient. All you need to do is use the /markspam command to delete the message and ban the user. This helps train the bot, and all users of this bot will benefit.\n9 Conclusion I thoroughly enjoyed this creative process: discovering a problem, having a spark of inspiration, building a prototype, and finally polishing it into a complete project.\nAlthough this is purely powered by passion â€“ the code is open source, and I have to pay for the server out of my own pocket, with no material return.\nBut every time I see the bot successfully block an spam, that joy of creation and see it\u0026rsquo;s working is the best reward.\nProject repository: https://github.com/ramsayleung/bayes_spam_sniper Try it now: https://t.me/BayesSpamSniperBot https://podcasts.apple.com/us/podcast/%E8%BD%AF%E4%BB%B6%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/id1147186605\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://liuyandong.com/sample-page\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://t.me/huruanhuying\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://t.me/kaedeharakazuha17\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://paulgraham.com/spam.html\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://www.youtube.com/watch?v=HZGCoVF3YvM\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://gist.github.com/ramsayleung/5848af0177a70a01d41f624e361b1b5d\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://ramsayleung.github.io/zh/post/2024/%E7%BC%96%E7%A8%8B%E5%8D%81%E5%B9%B4%E7%9A%84%E6%84%9F%E6%82%9F/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://ublockorigin.com/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://ramsayleung.github.io/zh/post/2025/a_philosophy_of_software_design/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttps://t.me/pipeapplebun\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://yuexuan521.github.io/en/post/2025/a_telegram_spam_blocker_bot_based_on_bayesian/","summary":"\u003ch2 id=\"preface\"\u003e\u003cspan class=\"section-num\"\u003e1\u003c/span\u003e Preface\u003c/h2\u003e\n\u003cp\u003eI spent a weekend building a Telegram spam blocker bot based on Bayesian Algorithm \u003ccode\u003e@BayesSpamSniperBot\u003c/code\u003e (\u003ca href=\"https://t.me/BayesSpamSniperBot\"\u003ehttps://t.me/BayesSpamSniperBot\u003c/a\u003e). The project is open-sourced at: \u003ca href=\"https://github.com/ramsayleung/bayes_spam_sniper\"\u003ehttps://github.com/ramsayleung/bayes_spam_sniper\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"telegram\"\u003e\u003cspan class=\"section-num\"\u003e1.1\u003c/span\u003e Telegram\u003c/h3\u003e\n\u003cp\u003eTelegram is a popular instant messaging application, similar to Snapchat and WhatsApp, with over 1 billion users.\u003c/p\u003e\n\u003cp\u003eIt supports many powerful features like cloud chat history storage, clients for Linux, Mac, Windows, Android, IOS, and Web (all open-source), Channel, and arguably the most powerful bot system I\u0026rsquo;ve ever seen.\u003c/p\u003e","title":"A Telegram Spam Blocker Bot Based On Bayesian Algorithm"},{"content":"About me I\u0026rsquo;m Ramsay, a software engineer making a living by pressing keyboard, an amateur cook, an Emacs deadhead and Linux enthusiast.\nThe slogan of this site is In pursuit of Simplicity, because I prefer simple over complex\nProjects I\u0026rsquo;ve contributed multiple projects to open source community, I mainly focus on RSpotify right now due to the constrained energy.\nRSpotify: A Spotify Web API wrapper implemented in Rust. ","permalink":"https://yuexuan521.github.io/en/about_me/","summary":"\u003ch2 id=\"about-me\"\u003eAbout me\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;m Ramsay, a software engineer making a living by pressing keyboard, an amateur cook, an Emacs deadhead and Linux enthusiast.\u003c/p\u003e\n\u003cp\u003eThe slogan of this site is \u003cstrong\u003e\u003cstrong\u003eIn pursuit of Simplicity\u003c/strong\u003e\u003c/strong\u003e, because I prefer simple over complex\u003c/p\u003e\n\u003ch2 id=\"projects\"\u003eProjects\u003c/h2\u003e\n\u003cp\u003eI\u0026rsquo;ve contributed multiple projects to open source community, I mainly focus on RSpotify right now due to the constrained energy.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ramsayleung/rspotify\"\u003eRSpotify\u003c/a\u003e: A Spotify Web API wrapper implemented in Rust.\u003c/li\u003e\n\u003c/ul\u003e","title":"About Me"}]